<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>運動島 Sports Island</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>

<body class="bg-slate-100">
<div class="max-w-md mx-auto bg-white min-h-screen flex flex-col">

<!-- BANNER -->
<img src="https://aiwe.cc/wp-content/uploads/2025/12/3486bc19dc6317e16bf4f1449ec52ae4.jpg" class="w-full">

<!-- 主內容 -->
<main class="flex-grow p-4" id="view-course"></main>
<main class="flex-grow p-4 hidden" id="view-member"></main>

<!-- 底部導覽 -->
<nav class="fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around py-2">
  <button onclick="showCourse()">課程</button>
  <button onclick="showMember()">會員</button>
</nav>

</div>

<script>
const API_URL = 'https://sport.wetw-net3.workers.dev/';
let currentUid = '';

async function init() {
  await liff.init({ liffId: '2008792551-CzPJtVB1' });
  if (!liff.isLoggedIn()) liff.login();
  const profile = await liff.getProfile();
  currentUid = profile.userId;
  loadCourses();
}

async function loadCourses() {
  const res = await fetch(API_URL, {
    method:'POST',
    body: JSON.stringify({ action:'getCourses' })
  }).then(r=>r.json());

  document.getElementById('view-course').innerHTML =
    res.data.map(c=>`
      <div class="border p-4 rounded mb-3">
        <div class="font-bold">${c.名稱}</div>
        <div class="text-sm">$${c.價格}</div>
      </div>
    `).join('');
}

async function showMember() {
  document.getElementById('view-course').classList.add('hidden');
  document.getElementById('view-member').classList.remove('hidden');

  const res = await fetch(API_URL,{
    method:'POST',
    body: JSON.stringify({ action:'getMembers', userId: currentUid })
  }).then(r=>r.json());

  document.getElementById('view-member').innerHTML =
    `<button onclick="addMember()" class="mb-4">＋ 新增家人</button>` +
    res.data.map(m=>`
      <div class="border p-3 mb-2">
        ${m.name}（${m.relation}）
      </div>
    `).join('');
}

function showCourse() {
  document.getElementById('view-member').classList.add('hidden');
  document.getElementById('view-course').classList.remove('hidden');
}

function addMember() {
  alert('下一步可加編輯表單');
}

window.onload = init;
</script>
</body>
</html>
