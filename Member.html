<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { background-color: #f0f2f5; }
    .aspect-banner { aspect-ratio: 21 / 9; }
    @media (min-width: 768px) { .aspect-banner { aspect-ratio: 3 / 1; } }
  </style>
</head>
<body class="min-h-screen flex justify-center">

  <div class="w-full max-w-4xl bg-white min-h-screen shadow-lg relative flex flex-col">
    
    <!-- Banner å€åŸŸ -->
    <div class="relative w-full aspect-banner bg-slate-200 overflow-hidden">
      <img src="https://aiwe.cc/wp-content/uploads/2025/12/3486bc19dc6317e16bf4f1449ec52ae4.jpg" 
           class="w-full h-full object-cover" alt="Banner">
      
      <!-- å³ä¸Šæ–¹å° Logo -->
      <div class="absolute top-3 right-3 md:top-6 md:right-6 z-20">
        <div class="bg-black/20 backdrop-blur-md p-1 rounded-full border border-white/30 shadow-lg">
          <img id="userAvatar" src="https://via.placeholder.com/100?text=..." 
               class="w-8 h-8 md:w-12 md:h-12 rounded-full object-cover bg-white">
        </div>
      </div>
    </div>

    <!-- æœƒå“¡å°ˆå€æ¨™é¡Œ -->
    <div class="px-6 py-8">
      <h1 id="userName" class="text-3xl font-black text-slate-800 tracking-tight leading-tight">è¼‰å…¥ä¸­...</h1>
      <p class="text-indigo-600 text-xs font-black uppercase tracking-[0.2em] mt-1">Member Registration</p>
    </div>

    <!-- è¡¨å–®å…§å®¹å€ -->
    <div class="px-6 space-y-6 flex-grow pb-32">
      <div class="bg-slate-50 rounded-[2.5rem] p-8 border border-slate-100 shadow-sm">
        <h2 class="font-black text-slate-700 text-lg mb-6 flex items-center">
          <span class="bg-white p-2 rounded-xl mr-3 shadow-sm text-sm">ğŸ“‹</span> å¡«å¯«å ±åè³‡æ–™
        </h2>
        
        <form id="regForm" class="space-y-5">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" id="stuName" placeholder="å­¸ç”Ÿå§“å" required 
                   class="w-full p-4 bg-white rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500 shadow-sm">
            <input type="tel" id="pPhone" placeholder="å®¶é•·è¯çµ¡é›»è©±" required 
                   class="w-full p-4 bg-white rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500 shadow-sm">
          </div>
          
          <select id="cId" class="w-full p-4 bg-white rounded-2xl border-none outline-none shadow-sm appearance-none">
            <option value="S01">é€±æœ«è¶³çƒé«”é©—èª² ($600)</option>
            <option value="B01">ç±ƒçƒåŸºç¤è¨“ç·´ç‡Ÿ ($2500)</option>
            <option value="C01">å…¨èƒ½äº”æ—¥ç‡Ÿ ($8500)</option>
          </select>

          <button type="submit" id="subBtn" 
                  class="w-full bg-indigo-600 text-white py-5 rounded-3xl font-black text-lg shadow-xl shadow-indigo-100 active:scale-95 transition-all mt-4">
            ç¢ºèªå ±å
          </button>
        </form>
      </div>
    </div>

    <!-- åº•éƒ¨å°è¦½åˆ— -->
    <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-4xl bg-white/95 backdrop-blur-xl border-t border-slate-100 px-12 py-5 flex justify-around items-center z-50">
      <a href="?p=index" class="flex flex-col items-center text-slate-400 hover:text-indigo-500">
        <span class="text-2xl">ğŸ </span>
        <span class="text-[10px] font-black mt-1 uppercase">èª²ç¨‹å°ˆå€</span>
      </a>
      <a href="?p=Member" class="flex flex-col items-center text-indigo-600">
        <span class="text-2xl">ğŸ‘¤</span>
        <span class="text-[10px] font-black mt-1 uppercase">æœƒå“¡ä¸­å¿ƒ</span>
      </a>
    </nav>
  </div>

  <script>
    let lineUid = "";
    const API_URL = window.location.href.split('?')[0];

    async function init() {
      try {
        await liff.init({ liffId: "2008792551-CzPJtVB1" });
        if (!liff.isLoggedIn()) {
          liff.login();
          return;
        }
        const profile = await liff.getProfile();
        lineUid = profile.userId;
        document.getElementById('userName').innerText = "æ‚¨å¥½ï¼Œ" + profile.displayName;
        document.getElementById('userAvatar').src = profile.pictureUrl;
      } catch (e) { console.error(e); }
    }

    document.getElementById('regForm').onsubmit = async (e) => {
      e.preventDefault();
      const btn = document.getElementById('subBtn');
      btn.disabled = true;
      btn.innerText = "å‚³é€ä¸­...";
      
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'register',
            userId: lineUid,
            name: document.getElementById('stuName').value,
            phone: document.getElementById('pPhone').value,
            courseId: document.getElementById('cId').value
          })
        });
        const res = await response.json();
        alert(res.msg);
        if(res.success) document.getElementById('regForm').reset();
      } catch (err) { alert("å ±åé€šè¨Šå¤±æ•—ï¼Œè«‹é‡è©¦"); }
      finally { btn.disabled = false; btn.innerText = "ç¢ºèªå ±å"; }
    };
    window.onload = init;
  </script>
</body>
</html>
