<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    .banner-img { width: 100%; height: 100%; object-fit: cover; }
    body { background-color: #cbd5e1; }
    .app-container { background-color: #f8fafc; }
  </style>
</head>
<body class="min-h-screen flex justify-center">

  <!-- ä¸»å®¹å™¨ (FB ç¶²é ç‰ˆæ ¼å¼) -->
  <div class="w-full max-w-4xl app-container min-h-screen shadow-2xl relative flex flex-col">
    
    <!-- Banner å€åŸŸ -->
    <div class="relative w-full aspect-[21/9] md:aspect-[3/1] bg-black overflow-hidden">
      <img src="https://aiwe.cc/wp-content/uploads/2025/12/3486bc19dc6317e16bf4f1449ec52ae4.jpg" 
           class="banner-img" alt="Banner">
      
      <!-- å³ä¸Šæ–¹å° Logo (ç”¨æˆ¶é ­åƒ) -->
      <div class="absolute top-4 right-4 z-20">
        <div class="flex items-center space-x-2 bg-black/30 backdrop-blur-md p-1.5 rounded-full border border-white/20">
          <img id="userAvatar" src="https://via.placeholder.com/40" class="w-8 h-8 rounded-full border border-white/50 object-cover shadow-sm">
        </div>
      </div>
    </div>

    <!-- æœƒå“¡å°ˆå€æ¨™é¡Œ -->
    <div class="px-6 md:px-12 mt-8 mb-6">
      <h1 id="userName" class="text-3xl font-black text-slate-800 tracking-tight">è¼‰å…¥ä¸­...</h1>
      <p class="text-indigo-500 text-xs font-black uppercase tracking-[0.2em] mt-1">Sport Island Member Center</p>
    </div>

    <!-- åŠŸèƒ½å…§å®¹å€ -->
    <div class="px-6 md:px-12 space-y-6 pb-32">
      
      <!-- å ±åè¡¨å–®å¡ç‰‡ -->
      <div class="bg-white rounded-[2.5rem] shadow-sm p-8 border border-slate-100">
        <h2 class="font-black text-slate-800 text-lg mb-6 flex items-center">
          <span class="bg-indigo-50 p-2 rounded-xl mr-3 text-sm">ğŸ“‹</span> èª²ç¨‹è¨»å†Šå ±å
        </h2>
        <form id="regForm" class="space-y-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input type="text" id="stuName" placeholder="å­¸ç”Ÿå§“å" required class="w-full p-4 bg-slate-50 rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500">
            <input type="tel" id="pPhone" placeholder="è¯çµ¡é›»è©±" required class="w-full p-4 bg-slate-50 rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500">
          </div>
          <select id="cId" class="w-full p-4 bg-slate-50 rounded-2xl border-none outline-none">
            <option value="S01">é€±æœ«è¶³çƒé«”é©—èª² ($600)</option>
            <option value="B01">ç±ƒçƒåŸºç¤è¨“ç·´ç‡Ÿ ($2500)</option>
            <option value="C01">å…¨èƒ½äº”æ—¥ç‡Ÿ ($8500)</option>
          </select>
          <button type="submit" id="subBtn" class="w-full bg-indigo-600 text-white py-5 rounded-3xl font-black shadow-lg mt-4 active:scale-95 transition-all">é€å‡ºå ±åè³‡æ–™</button>
        </form>
      </div>

      <!-- å¿«æ·å·¥å…·å€ -->
      <div class="grid grid-cols-2 gap-4">
        <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 text-center">
          <div class="text-2xl mb-1">ğŸ“…</div>
          <div class="text-[10px] font-bold text-slate-700 uppercase">å ±åç´€éŒ„</div>
        </div>
        <div class="bg-white p-6 rounded-3xl shadow-sm border border-slate-100 text-center">
          <div class="text-2xl mb-1">ğŸ’³</div>
          <div class="text-[10px] font-bold text-slate-700 uppercase">ç¹³è²»é€šçŸ¥</div>
        </div>
      </div>
    </div>

    <!-- åº•éƒ¨å°è¦½åˆ— -->
    <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-4xl bg-white/90 backdrop-blur-xl border-t border-slate-100 px-12 py-5 flex justify-around items-center z-50">
      <a href="?p=index" class="flex flex-col items-center text-slate-400 group">
        <span class="text-2xl group-active:scale-90 transition-transform">ğŸ </span>
        <span class="text-[10px] font-black mt-1 uppercase">èª²ç¨‹å°ˆå€</span>
      </a>
      <a href="?p=Member" class="flex flex-col items-center text-indigo-600 group">
        <span class="text-2xl group-active:scale-90 transition-transform">ğŸ‘¤</span>
        <span class="text-[10px] font-black mt-1 uppercase">æœƒå“¡ä¸­å¿ƒ</span>
      </a>
    </nav>
  </div>

  <script>
    let lineUid = "";
    const API_URL = window.location.href.split('?')[0];

    async function init() {
      try {
        await liff.init({ liffId: "2008792551-CzPJtVB1" });
        if (!liff.isLoggedIn()) { liff.login(); return; }
        const profile = await liff.getProfile();
        lineUid = profile.userId;
        document.getElementById('userName').innerText = "æ‚¨å¥½ï¼Œ" + profile.displayName;
        document.getElementById('userAvatar').src = profile.pictureUrl;
      } catch (e) { console.error(e); }
    }

    document.getElementById('regForm').onsubmit = async (e) => {
      e.preventDefault();
      const btn = document.getElementById('subBtn');
      btn.disabled = true;
      btn.innerText = "å‚³é€ä¸­...";
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'register',
            userId: lineUid,
            name: document.getElementById('stuName').value,
            phone: document.getElementById('pPhone').value,
            courseId: document.getElementById('cId').value
          })
        });
        const res = await response.json();
        alert(res.msg);
        if(res.success) document.getElementById('regForm').reset();
      } catch (err) { alert("é€šè¨Šå¤±æ•—"); }
      finally { btn.disabled = false; btn.innerText = "é€å‡ºå ±åè³‡æ–™"; }
    };
    window.onload = init;
  </script>
</body>
</html>
