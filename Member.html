<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { background-color: #f0f2f5; }
    .aspect-banner { aspect-ratio: 21 / 9; }
    @media (min-width: 768px) { .aspect-banner { aspect-ratio: 3 / 1; } }
    .page-view { display: none; }
    .page-view.active { display: block; }
    /* éš±è—æ²è»¸ */
    .no-scrollbar::-webkit-scrollbar { display: none; }
  </style>
</head>
<body class="min-h-screen flex justify-center">

  <div class="w-full max-w-4xl bg-white min-h-screen shadow-lg relative flex flex-col">
    
    <!-- 1. é ‚éƒ¨ç‹€æ…‹åˆ— (æ”¾ç½® Logoï¼Œä¸é®æ“‹ Banner) -->
    <div class="w-full bg-white px-4 py-2 flex justify-between items-center border-b border-slate-100 z-30">
      <div class="flex items-center space-x-2">
        <div class="w-6 h-6 bg-indigo-600 rounded-md flex items-center justify-center text-white text-[10px] font-black">SI</div>
        <span class="text-xs font-bold text-slate-400 uppercase tracking-tighter">Sports Island</span>
      </div>
      <!-- å°å°ºå¯¸ç”¨æˆ¶ Logo -->
      <div id="userLogo" class="opacity-0 transition-opacity duration-500">
        <img id="userAvatar" src="" class="w-8 h-8 rounded-full border border-slate-200 object-cover bg-slate-100 shadow-sm">
      </div>
    </div>

    <!-- 2. Banner å€åŸŸ (ç­‰æ¯”ç¸®æ”¾) -->
    <div class="relative w-full aspect-banner bg-slate-200 overflow-hidden">
      <img src="https://aiwe.cc/wp-content/uploads/2025/12/3486bc19dc6317e16bf4f1449ec52ae4.jpg" 
           class="w-full h-full object-cover" alt="Banner">
    </div>

    <!-- 3. é é¢å…§å®¹å€ (å–®é åˆ‡æ›é‚è¼¯) -->
    <main class="flex-grow pb-32">
      
      <!-- é é¢ A: èª²ç¨‹å°ˆå€ (index) -->
      <div id="view-index" class="page-view active">
        <div class="px-6 py-8">
          <h2 class="text-2xl font-black text-slate-800 flex items-center">
            <span class="w-1.5 h-6 bg-indigo-600 rounded-full mr-3"></span>
            2026 èª²ç¨‹å°ˆå€
          </h2>
          <p class="text-slate-400 text-xs mt-1 font-bold uppercase tracking-widest">Available Courses</p>
        </div>
        <div class="px-6 space-y-4">
          <div class="bg-slate-50 p-5 rounded-3xl border border-slate-100 flex items-center active:scale-95 transition-all">
            <div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center text-3xl mr-4 shadow-sm">âš½</div>
            <div class="flex-grow">
              <h3 class="font-bold text-slate-800">é€±æœ«è¶³çƒé«”é©—èª²</h3>
              <p class="text-[10px] text-slate-400 font-black uppercase tracking-wider">$600 / Session</p>
            </div>
            <button onclick="switchPage('Member')" class="bg-indigo-600 text-white px-6 py-2.5 rounded-2xl text-xs font-bold shadow-md">å ±å</button>
          </div>
          <div class="bg-slate-50 p-5 rounded-3xl border border-slate-100 flex items-center active:scale-95 transition-all">
            <div class="w-14 h-14 bg-white rounded-2xl flex items-center justify-center text-3xl mr-4 shadow-sm">ğŸ€</div>
            <div class="flex-grow">
              <h3 class="font-bold text-slate-800">ç±ƒçƒåŸºç¤è¨“ç·´ç‡Ÿ</h3>
              <p class="text-[10px] text-slate-400 font-black uppercase tracking-wider">$2500 / Term</p>
            </div>
            <button onclick="switchPage('Member')" class="bg-indigo-600 text-white px-6 py-2.5 rounded-2xl text-xs font-bold shadow-md">å ±å</button>
          </div>
        </div>
      </div>

      <!-- é é¢ B: æœƒå“¡ä¸­å¿ƒ (Member) -->
      <div id="view-Member" class="page-view">
        <div class="px-6 py-8">
          <h1 id="userName" class="text-3xl font-black text-slate-800 tracking-tight leading-tight">é©—è­‰ä¸­...</h1>
          <p class="text-indigo-600 text-xs font-black uppercase tracking-[0.2em] mt-1">Member Registration</p>
        </div>
        <div class="px-6 space-y-6">
          <div class="bg-slate-50 rounded-[2.5rem] p-8 border border-slate-100 shadow-sm">
            <h2 class="font-black text-slate-700 text-lg mb-6 flex items-center">
              <span class="bg-white p-2 rounded-xl mr-3 shadow-sm">ğŸ“‹</span> å¡«å¯«å ±åè³‡æ–™
            </h2>
            <form id="regForm" class="space-y-5">
              <input type="text" id="stuName" placeholder="å­¸ç”Ÿå§“å" required class="w-full p-4 bg-white rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500 shadow-sm">
              <input type="tel" id="pPhone" placeholder="å®¶é•·è¯çµ¡é›»è©±" required class="w-full p-4 bg-white rounded-2xl border-none outline-none focus:ring-2 focus:ring-indigo-500 shadow-sm">
              <select id="cId" class="w-full p-4 bg-white rounded-2xl border-none outline-none shadow-sm appearance-none">
                <option value="S01">é€±æœ«è¶³çƒé«”é©—èª² ($600)</option>
                <option value="B01">ç±ƒçƒåŸºç¤è¨“ç·´ç‡Ÿ ($2500)</option>
                <option value="C01">å…¨èƒ½äº”æ—¥ç‡Ÿ ($8500)</option>
              </select>
              <button type="submit" id="subBtn" class="w-full bg-indigo-600 text-white py-5 rounded-3xl font-black text-lg shadow-xl shadow-indigo-100 active:scale-95 transition-all mt-4">ç¢ºèªå ±å</button>
            </form>
          </div>
        </div>
      </div>

    </main>

    <!-- 4. åº•éƒ¨å°è¦½åˆ— -->
    <nav class="fixed bottom-0 left-1/2 -translate-x-1/2 w-full max-w-4xl bg-white/95 backdrop-blur-md border-t border-slate-100 px-12 py-5 flex justify-around items-center z-50">
      <button onclick="switchPage('index')" id="nav-index" class="nav-item flex flex-col items-center text-indigo-600">
        <span class="text-2xl">ğŸ </span>
        <span class="text-[10px] font-black mt-1 uppercase">èª²ç¨‹å°ˆå€</span>
      </button>
      <button onclick="switchPage('Member')" id="nav-Member" class="nav-item flex flex-col items-center text-slate-400">
        <span class="text-2xl">ğŸ‘¤</span>
        <span class="text-[10px] font-black mt-1 uppercase">æœƒå“¡ä¸­å¿ƒ</span>
      </button>
    </nav>
  </div>

  <script>
    let lineUid = "";
    const API_URL = window.location.href.split('?')[0];

    // åˆ‡æ›é é¢å‡½å¼ (ä¸é‡è¼‰ç¶²é )
    function switchPage(pageId) {
      document.querySelectorAll('.page-view').forEach(p => p.classList.remove('active'));
      document.getElementById('view-' + pageId).classList.add('active');
      
      // æ›´æ–° Nav é¡è‰²
      document.querySelectorAll('.nav-item').forEach(n => n.classList.replace('text-indigo-600', 'text-slate-400'));
      document.getElementById('nav-' + pageId).classList.replace('text-slate-400', 'text-indigo-600');
      
      // æ²å›é ‚éƒ¨
      window.scrollTo(0, 0);
    }

    async function init() {
      try {
        await liff.init({ liffId: "2008792551-CzPJtVB1" });
        if (!liff.isLoggedIn()) {
          liff.login();
          return;
        }
        const profile = await liff.getProfile();
        lineUid = profile.userId;
        
        // é¡¯ç¤ºé ‚éƒ¨é ­åƒ
        document.getElementById('userAvatar').src = profile.pictureUrl;
        document.getElementById('userLogo').style.opacity = "1";
        
        // æ›´æ–°æœƒå“¡ä¸­å¿ƒæ­¡è¿è©
        document.getElementById('userName').innerText = "æ‚¨å¥½ï¼Œ" + profile.displayName;

        // æª¢æŸ¥ç¶²å€åƒæ•¸æ˜¯å¦æœ‰æŒ‡å®šåˆå§‹é é¢
        const urlParams = new URLSearchParams(window.location.search);
        const startPage = urlParams.get('p');
        if (startPage === 'Member') switchPage('Member');
        
      } catch (e) { console.error("LIFF Init Failed", e); }
    }

    document.getElementById('regForm').onsubmit = async (e) => {
      e.preventDefault();
      const btn = document.getElementById('subBtn');
      btn.disabled = true;
      btn.innerText = "å‚³é€ä¸­...";
      try {
        const response = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            action: 'register',
            userId: lineUid,
            name: document.getElementById('stuName').value,
            phone: document.getElementById('pPhone').value,
            courseId: document.getElementById('cId').value
          })
        });
        const res = await response.json();
        alert(res.msg);
        if(res.success) document.getElementById('regForm').reset();
      } catch (err) { alert("å ±åé€šè¨Šå¤±æ•—"); }
      finally { btn.disabled = false; btn.innerText = "ç¢ºèªå ±å"; }
    };

    window.onload = init;
  </script>
</body>
</html>
